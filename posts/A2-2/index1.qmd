---
title: "Assignment 2-2"
format: html
editor: visual
---

## Introduction
I am examining a dataset reguarding applicant resumes and background in job applications 

## Setup

```{r}
#|label: setup
library(tidyverse)
library(skimr)
library(ggformula)
library(vcd)
library(vcdExtra)
library(vcdExtra)
library(openintro)
library(resampledata)
library(ggalluvial)
```

## Loading and Inspecting the data

```{r}
resume_names <- read_csv("../Data/ResumeNames.csv")
glimpse(resume_names)
```

## Data Dictionary

name: indicating applicant's first name.

gender: indicating gender.

ethnicity: indicating ethnicity (i.e., Caucasian-sounding vs. African-American sounding first name).

quality: indicating quality of resume.

call: Was the applicant called back?

city: indicating city: Boston or Chicago.

jobs: number of jobs listed on resume.

experience: number of years of work experience on the resume.

honors: Did the resume mention some honors?

volunteer: Did the resume mention some volunteering experience?

military: Does the applicant have military experience?

holes: Does the resume have some employment holes?

school: Does the resume mention some work experience while at school?

email: Was the e-mail address on the applicant's resume?

computer: Does the resume mention some computer skills?

special: Does the resume mention some special skills?

college:. Does the applicant have a college degree or more?

minimum: indicating minimum experience requirement of the employer.

equal: Is the employer EOE (equal opportunity employment)?

wanted: indicating type of position wanted by employer.

requirements: Does the ad mention some requirement for the job?

reqexp: Does the ad mention some experience requirement?

reqcomm: Does the ad mention some communication skills requirement?

reqeduc: Does the ad mention some educational requirement?

reqcomp: Does the ad mention some computer skills requirement?

reqorg: Does the ad mention some organizational skills requirement?

industry: indicating type of employer industry.


## Data Munging

```{r}
resume_modified <- resume_names %>% 
  mutate(
    name = as_factor(name),
    gender = as_factor(gender),
    ethnicity = as_factor(ethnicity),
    quality = as_factor(quality),
    call = as_factor(call),
    city = as_factor(city),
    honors = as_factor(honors),
    volunteer = as_factor(volunteer),
    military = as_factor(military),
    holes = as_factor(holes),
    school = as_factor(school),
    email = as_factor(email),
    computer = as_factor(computer),
    special = as_factor(special),
    college = as_factor(college),
    minimum = as_factor(minimum),
    equal = as_factor(equal),
    wanted = as_factor(wanted),
    requirements = as_factor(requirements),
    reqexp = as_factor(reqexp),
    reqcomm = as_factor(reqcomm),
    reqeduc = as_factor(reqeduc),
    reqcomp = as_factor(reqcomp),
    reqorg = as_factor(reqorg),
    industry = as_factor(industry)
  )
glimpse(resume_modified)
```

## Visualising impact of Ethinicity in getting a Callback for Jobs despite quality of the Resume

```{r}
resume_modified %>% gf_bar(~ ethnicity, fill = ~ call, color = "black") %>%
  gf_facet_wrap(~ quality) %>%
  gf_labs(title = "Callbacks by Ethnicity despite Quality of Resumes",
          x="Ethnicity") %>% 
  gf_refine(scale_fill_paletteer_d("basetheme::royal"))
```
Comments

The graph shows that in both the low and high quality resumes, caucasian applicants receive more callbacks for jobs than afam applicants. There is a visible increase in number of callbacks with better quality resumes, but the difference between both ethnicities still remains.

## Visualising the impact of Additional Skills in receiving Callbacks for Jobs 

```{r}
acall_table <- vcd::structable(special ~ call, data = resume_modified)
vcd::mosaic(acall_table, gp = shading_max, main = "Additional Skills impacting Callbacks")
```
Comments

The graph shows that the applicants with additional skills receive more callbacks than those with none. Therefore stating that applicants have with additional skills have a better chance of getting job placements.

## Visualising Experience levels impact on receiving Callbacks for Jobs

```{r}
resume_modified %>% gf_boxplot(call ~ experience, fill = ~ call) %>%
  gf_labs(title = "Experience Levels of Applicants and Callbacks") %>% 
  gf_refine(scale_fill_paletteer_d("basetheme::royal"))
```
Comments

The graph shows that the callbacks are not really dependent on the applicants' years of experience as applicants who have and have not received callbacks have similar years of experience. The median year of both are also very similar. Although there is a suprising outlier who has not received a callback even with almost 50 years of experience.

## Visualising impact of Emails in getting Callbacks for Jobs across the various Experience levels

```{r}
resume_modified %>% gf_density(~ experience, fill = ~ email, color = "black") %>%
  gf_facet_wrap(~ call) %>%
  gf_labs(title = "Callbacks by Experience and Emails") %>% 
  gf_refine(scale_fill_paletteer_d("basetheme::minimal"))
```
Comments

The graph shows that the applicants who received callbacks and have email are more widespread. In case of applicants who have not received callbacks, the ones who have and have not emailed have similar distributions showing no real difference. This suggests, applicants who email have a better chance of recieving callbacks despite their experience level.

## Visualising applicants receiving Callbacks based on Gender, Ethnicity and Quality of Resume

```{r}
resume_modified %>% 
  
  ggplot(aes(axis1 = gender, axis2 = ethnicity, axis3 = quality, axis4 = call)) + 
  geom_alluvium(aes(fill = gender), alpha = 0.5) + 
  geom_stratum() + 
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) + scale_x_discrete(limits = c("Gender", "Ethnicity", "Resume Quality", "Callback")) +
  labs(title = "Callbacks based on Gender, Ethnicity and Quality of Resume") 
```
Comments

The grapf shows that despite having high resume quality, a large portion of applicants, especially from afam groups end up receiving no callbacks. In terms of gender, more female applicants have received callbacks as compared to male applicants.

## Visualising applicants receiving Callbacks based on College, Additional Skills and Quality of Resume

```{r}
resume_modified %>% 
  
  ggplot(aes(axis1 = college, axis2 = special, axis3 = quality, axis4 = call)) + 
  geom_alluvium(aes(fill = college), alpha = 0.5) + 
  geom_stratum() + 
  geom_label(stat = "stratum", aes(label = after_stat(stratum))) + scale_x_discrete(limits = c("College", "Additional Skills", "Resume Quality", "Callback")) +
  labs(title = "Resume quality over Etnicity")
```
Comments

The graph shows that many applicants with college education and additional skills have high-quality resumes but still a large number still ends up receiving no callbacks showing that there is no necessary relation between them. Even among applicants who have all three advantages, college, special skills, and high quality resumes, a vast majority does not receive any callbacks, suggesting other factors which are not a show of merit have an impact.